library("ggplot2")
# Define the sequence of values
values <- c(1.780330085889911, 1.836516303737808, 1.8365163037378083, 1.853553390593274, 1.8927025215857052, 1.8927025215857054, 1.9085777065554923, 1.9085777065554925, 1.9097396084411713, 1.9244528915252794, 1.9256147934109582, 1.9256147934109584, 1.926776695296637, 1.9488887394336025, 1.9647639244033894, 1.9647639244033896, 1.9647639244033899, 1.9659258262890682, 1.9659258262890684, 1.9659258262890686, 1.9806391093731768, 1.980639109373177, 1.9818010112588553, 1.9818010112588555, 1.982962913144534, 1.9829629131445343, 1.9976761962286425, 1.9976761962286427, 1.997676196228643, 1.9988380981143212, 1.9988380981143214, 2.0, 2.0050749572815, 2.0221120441369655, 2.0379872291067525, 2.037987229106753, 2.0391491309924312, 2.0391491309924317, 2.05386241407654, 2.0538624140765402, 2.0550243159622186, 2.0561862178478973, 2.061261175129397, 2.0708995009320055, 2.070899500932006, 2.0720614028176843, 2.0720614028176847, 2.078298261984863, 2.09417344695465, 2.0941734469546502, 2.0953353488403286, 2.095335348840329, 2.110048631924437, 2.1112105338101155, 2.111210533810116, 2.1123724356957947, 2.127085718779903, 2.1270857187799033, 2.1282476206655816, 2.128247620665582, 2.1344844798327602, 2.14296090374969, 2.1441228056353685, 2.144122805635369, 2.1452847075210473, 2.150359664802547, 2.1503596648025476, 2.151521566688226, 2.167396751658013, 2.1673967516580133, 2.1685586535436916, 2.168558653543692, 2.1832719366278, 2.1832719366278006, 2.184433838513479, 2.1906706976806576, 2.199147121597587, 2.1991471215975875, 2.200309023483266, 2.2003090234832663, 2.2014709253689446, 2.2077077845361233, 2.216184208453053, 2.217346110338732, 2.22358296950591, 2.2235829695059106, 2.224744871391589, 2.2247448713915894, 2.2394581544756975, 2.240620056361376, 2.2406200563613763, 2.256495241331163, 2.2564952413311636, 2.257657143216842, 2.2638940023840206, 2.27237042630095, 2.2723704263009505, 2.273532328186629, 2.2735323281866293, 2.2797691873538075, 2.279769187353808, 2.2809310892394863, 2.289407513156416, 2.2894075131564167, 2.290569415042095, 2.296806274209273, 2.2968062742092736, 2.3126814591790605, 2.312681459179061, 2.313843361064739, 2.3138433610647393, 2.320080220231918, 2.3285566441488474, 2.328556644148848, 2.329718546034526, 2.3297185460345267, 2.3371173070873836, 2.345593731004313, 2.3455937310043136, 2.345593731004314, 2.346755632889992, 2.3467556328899923, 2.3529924920571705, 2.352992492057171, 2.361468915974101, 2.3626308178597792, 2.368867677026958, 2.370029578912636, 2.3700295789126367, 2.385904763882423, 2.3859047638824236, 2.385904763882424, 2.393303524935281, 2.4017799488522105, 2.401779948852211, 2.4029418507378892, 2.4029418507378897, 2.409178709905068, 2.4091787099050683, 2.417655133821998, 2.4188170357076766, 2.4262157967605336, 2.426215796760534, 2.434692220677464, 2.4420909817303205, 2.442090981730321, 2.4494897427831783, 2.457966166700108, 2.4579661667001083, 2.4591280685857866, 2.459128068585787, 2.475003253555574, 2.482402014608431, 2.4824020146084314, 2.498277199578218, 2.4982771995782183, 2.5153142864336835, 2.515314286433684, 2.5153142864336844, 2.531189471403471, 2.5311894714034713, 2.5385882324563283, 2.5385882324563287, 2.547064656373258, 2.571500504281581, 2.5715005042815813, 2.6276867221294786, 1.7071067811865477, 1.7632929990344448, 1.779168184004232, 1.7791681840042322, 1.7803300858899107, 1.8194792168823422, 1.835354401852129, 1.8353544018521293, 1.8353544018521295, 1.8365163037378078, 1.8512295868219164, 1.8512295868219166, 1.8523914887075952, 1.8535533905932737, 1.8756654347302395, 1.908577706555492, 1.9097396084411709, 1.909739608441171, 1.9244528915252797, 1.9318516525781368, 2.0209501422512868, 2.020950142251287, 2.0697375990463267, 2.069737599046327, 2.1429609037496897, 2.1844338385134785, 2.2882456112707374, 2.3614689159741005)

# Define the repetition counts
reps <- c(48, 112, 40, 200, 432, 72, 248, 336, 256, 208, 552, 144, 224, 624, 200, 72, 344, 368, 72, 144, 976, 224, 320, 1056, 168, 288, 96, 1440, 72, 344, 304, 264, 824, 832, 936, 1160, 304, 272, 2016, 48, 1488, 336, 424, 872, 672, 240, 248, 960, 904, 808, 552, 120, 1944, 520, 2184, 336, 2664, 432, 1104, 208, 1008, 1632, 680, 656, 144, 384, 296, 896, 920, 1472, 192, 192, 3576, 72, 1384, 624, 320, 736, 1792, 736, 240, 704, 832, 344, 864, 888, 384, 48, 2096, 208, 968, 3320, 216, 336, 728, 400, 1984, 312, 496, 552, 320, 480, 240, 24, 24, 568, 704, 2760, 72, 72, 456, 592, 400, 672, 1056, 320, 432, 88, 904, 24, 48, 48, 760, 512, 48, 48, 1640, 168, 312, 40, 1512, 48, 432, 280, 920, 144, 96, 424, 144, 480, 192, 192, 192, 48, 64, 1048, 360, 192, 256, 120, 24, 240, 240, 144, 24, 464, 24, 144, 24, 48, 48, 144, 48, 192, 24, 120, 72, 32, 64, 64, 64, 64, 160, 32, 32, 64, 160, 160, 160, 128, 64, 192, 32, 96, 96, 256, 128, 64, 64, 128, 384, 64, 48,576, 32)

# Create the vector by repeating values according to reps
Dist_merge_2cubes_4Y_X <- rep(values, times = reps)

      
Dist_merge_2cubes_4Y_X<-lapply(Dist_merge_2cubes_4Y_X,"*", 0.5)
Dist_merge_2cubes_4Y_X<-as.numeric(Dist_merge_2cubes_4Y_X)

standard_deviation <- sd(Dist_merge_2cubes_4Y_X)

# Create a data frame
# Create a data frame
data <- data.frame(values = Dist_merge_2cubes_4Y_X)

# Create a histogram and density plot to visualize the distribution of mean point-to-point distances of TADs,
# with a specified bandwidth for the density plot and customized axis labels and font styles.

# bandwidth parameter controls the smoothness of the curve or line and affects how closely it fits the data
#points. A higher bandwidth results in a smoother curve, while a lower bandwidth leads to a more jagged representation 
#that closely follows the data points.

plot <- ggplot(data, aes(x = values)) +
  geom_histogram(aes(y = ..density..), bins = 21, fill = "lightblue", color = "black") +
  geom_density(color = "red", bw = 0.04) +  # Adjust the bandwidth value (e.g., 0.1)
  labs(x= expression(paste("Mean point-to-point distance of TADs")) 
       , y = "Density of valid paths with length = 100 kb") +
  ggtitle("") +
  theme_minimal()+
  theme(panel.background = element_rect(fill = "gray90"),
axis.text = element_text(size = 14, color = "black"),  # Change font of x-ticks and y-ticks
axis.title.x = element_text(size = 14, color = "black", margin = margin(t = 10)),  # Change font of x-label
axis.title.y = element_text(size = 14, color = "black", margin = margin(r = 10)))  # Change font of y-label

# Customize the tick labels further if needed
plot <- plot + scale_x_continuous(breaks = c(min(Dist_merge_2cubes_4Y_X), 0.18, 0.2, 0.22, 0.24, 0.25, 0.27, max(Dist_merge_2cubes_4Y_X)), labels = scales::number_format(accuracy = 0.01))
                                  
# Save the plot as a PNG file
ggsave("histogram_plot.png", plot, width = 6, height = 4, dpi = 300)

